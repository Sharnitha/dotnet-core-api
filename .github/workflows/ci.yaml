name: Dotnetapplication

on:
  workflow_dispatch:
  # push:
  #   branches:
  #   - master

jobs:
  DotnetInstall:
    name: Run dotnet on Ubuntu
    runs-on: self-hosted
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Dotnet install
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '6.0.x'
           
  Install_dependencies:
    runs-on: ubuntu-latest
    needs: DotnetInstall
    steps:
       - name: Checkout code
         uses: actions/checkout@v4
       - name: Installing dependency
         run: dotnet restore

  Build_dotnet:
    runs-on: ubuntu-latest
    needs: Install_dependencies
    steps:
       - name: Checkout code
         uses: actions/checkout@v4
       - name: Installing dependency
         run: dotnet build --configuration Release
      
  Publish_dotnet:
      runs-on: ubuntu-latest
      # needs: Build_dotnet
      steps:
         - name: Checkout code
           uses: actions/checkout@v4
         - name: Installing dependency
           run: dotnet publish --configuration Release  
           
         - name: UploadArtifact
           uses: actions/upload-artifact@v4.3.1
           with:
             name: dotnetdll
             path: bin/Release/netcoreapp3.1/TodoApi.dll

  # Build_image:
  #   runs-on: ubuntu-latest
  #   needs: Publish_dotnet
  #   steps:
  #     - name: Checkout code
  #       uses: actions/checkout@v4
  #     - name: Download Dll file
  #       run: gh run download ${{ github.run_id }}
  #     - name: Build Docker image
  #       run: |
  #         docker build -t demodotnet:${{ github.run_id }} .
          
        
  
